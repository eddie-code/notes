[TOC]

## 目录

- [1. 链路追踪在微服务中的作用](#1-链路追踪在微服务中的作用)
- [2. 链路追踪的基本功能](#2-链路追踪的基本功能)
- [3. Sleuth的链路追踪介绍](#3-sleuth的链路追踪介绍)

# SpringCloud微服务调用链追踪

## 1. 链路追踪在微服务中的作用

微服务之间的调用关系是网状的

根本无法用人力梳理出上线游调用关系，通过调用链追踪技术进行调用关系梳理，得处调用拓扑图，理清上下游关系以及更细粒度的时间报表

- 谁是你的大客户，调用你的次数最多
- 你的服务在每个环节的响应时间是多少

## 2. 链路追踪的基本功能

- 分布式环境下的链路追踪
- 获知Timing信息：还可以根据执行时间的多少触发相应的预警信息
- 定位链路功能：对于整个链路有一个traceId，通过这个id可以获取整个链路的信息
- 信息的收集和展示

## 3. Sleuth的链路追踪介绍

HTTP-->服务A-->服务D-->服务C-->服务F

用户请求访问了服务A，接着服务A又在内部先后调用了服务D，C和F，在这里Sleuth的工作就是通过一种“打标”的机制，将这个链路上的所有被访问到的服务打上一个相同的标记，这样我们只要拿到这个标记，就很容易可以追溯到链路上下游所有的调用

借助Sleuth的链路追踪能力，我们还可以完成一些其他的任务，比如说：

1. **线上故障定位**：结合Tracking ID寻找上下游链路中所有的日志信息（这一步还需要借助一些其他开源组件）
2. **依赖分析梳理**：梳理上下游依赖关系，理清整个系统中所有微服务之间的依赖关系
3. **链路优化**：比如说目前我们有三种途径可以导流到下单接口，通过对链路调用情况的统计分析，我们可以识别出转化率最高的业务场景，从而为以后的产品设计提供指导意见。
4. **性能分析**：梳理各个环节的时间消耗，找到性能瓶颈，为性能优化、软硬件资源调配指明方向